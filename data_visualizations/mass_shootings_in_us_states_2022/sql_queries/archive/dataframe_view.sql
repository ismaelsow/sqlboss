CREATE OR REPLACE VIEW mass_shootings.dataframe_view AS
  (
    SELECT    year,
              MAX(CASE WHEN state = 'Alabama' THEN victims_per_1m ELSE 0 END) AS alabama,
              MAX(CASE WHEN state = 'Alaska' THEN victims_per_1m ELSE 0 END) AS alaska,
              MAX(CASE WHEN state = 'Arizona' THEN victims_per_1m ELSE 0 END) AS arizona,
              MAX(CASE WHEN state = 'Arkansas' THEN victims_per_1m ELSE 0 END) AS arkansas,
              MAX(CASE WHEN state = 'California' THEN victims_per_1m ELSE 0 END) AS california,
              MAX(CASE WHEN state = 'Colorado' THEN victims_per_1m ELSE 0 END) AS colorado,
              MAX(CASE WHEN state = 'Connecticut' THEN victims_per_1m ELSE 0 END) AS connecticut,
              MAX(CASE WHEN state = 'Delaware' THEN victims_per_1m ELSE 0 END) AS delaware,
              MAX(CASE WHEN state = 'District of Columbia' THEN victims_per_1m ELSE 0 END) AS district_of_columbia,
              MAX(CASE WHEN state = 'Florida' THEN victims_per_1m ELSE 0 END) AS florida,
              MAX(CASE WHEN state = 'Georgia' THEN victims_per_1m ELSE 0 END) AS georgia,
              MAX(CASE WHEN state = 'Idaho' THEN victims_per_1m ELSE 0 END) AS idaho,
              MAX(CASE WHEN state = 'Illinois' THEN victims_per_1m ELSE 0 END) AS illinois,
              MAX(CASE WHEN state = 'Indiana' THEN victims_per_1m ELSE 0 END) AS indiana,
              MAX(CASE WHEN state = 'Iowa' THEN victims_per_1m ELSE 0 END) AS iowa,
              MAX(CASE WHEN state = 'Kansas' THEN victims_per_1m ELSE 0 END) AS kansas,
              MAX(CASE WHEN state = 'Kentucky' THEN victims_per_1m ELSE 0 END) AS kentucky,
              MAX(CASE WHEN state = 'Louisiana' THEN victims_per_1m ELSE 0 END) AS louisiana,
              MAX(CASE WHEN state = 'Maine' THEN victims_per_1m ELSE 0 END) AS maine,
              MAX(CASE WHEN state = 'Maryland' THEN victims_per_1m ELSE 0 END) AS maryland,
              MAX(CASE WHEN state = 'Massachusetts' THEN victims_per_1m ELSE 0 END) AS massachusetts,
              MAX(CASE WHEN state = 'Michigan' THEN victims_per_1m ELSE 0 END) AS michigan,
              MAX(CASE WHEN state = 'Minnesota' THEN victims_per_1m ELSE 0 END) AS minnesota,
              MAX(CASE WHEN state = 'Mississippi' THEN victims_per_1m ELSE 0 END) AS mississippi,
              MAX(CASE WHEN state = 'Missouri' THEN victims_per_1m ELSE 0 END) AS missouri,
              MAX(CASE WHEN state = 'Montana' THEN victims_per_1m ELSE 0 END) AS montana,
              MAX(CASE WHEN state = 'Nebraska' THEN victims_per_1m ELSE 0 END) AS nebraska,
              MAX(CASE WHEN state = 'Nevada' THEN victims_per_1m ELSE 0 END) AS nevada,
              MAX(CASE WHEN state = 'New Hampshire' THEN victims_per_1m ELSE 0 END) AS new_hampshire,
              MAX(CASE WHEN state = 'New Jersey' THEN victims_per_1m ELSE 0 END) AS new_jersey,
              MAX(CASE WHEN state = 'New Mexico' THEN victims_per_1m ELSE 0 END) AS new_mexico,
              MAX(CASE WHEN state = 'New York' THEN victims_per_1m ELSE 0 END) AS new_york,
              MAX(CASE WHEN state = 'North Carolina' THEN victims_per_1m ELSE 0 END) AS north_carolina,
              MAX(CASE WHEN state = 'Ohio' THEN victims_per_1m ELSE 0 END) AS ohio,
              MAX(CASE WHEN state = 'Oklahoma' THEN victims_per_1m ELSE 0 END) AS oklahoma,
              MAX(CASE WHEN state = 'Oregon' THEN victims_per_1m ELSE 0 END) AS oregon,
              MAX(CASE WHEN state = 'Pennsylvania' THEN victims_per_1m ELSE 0 END) AS pennsylvania,
              MAX(CASE WHEN state = 'Rhode Island' THEN victims_per_1m ELSE 0 END) AS rhode_island,
              MAX(CASE WHEN state = 'South Carolina' THEN victims_per_1m ELSE 0 END) AS south_carolina,
              MAX(CASE WHEN state = 'South Dakota' THEN victims_per_1m ELSE 0 END) AS south_dakota,
              MAX(CASE WHEN state = 'Tennessee' THEN victims_per_1m ELSE 0 END) AS tennessee,
              MAX(CASE WHEN state = 'Texas' THEN victims_per_1m ELSE 0 END) AS texas,
              MAX(CASE WHEN state = 'Utah' THEN victims_per_1m ELSE 0 END) AS utah,
              MAX(CASE WHEN state = 'Vermont' THEN victims_per_1m ELSE 0 END) AS vermont,
              MAX(CASE WHEN state = 'Virginia' THEN victims_per_1m ELSE 0 END) AS virginia,
              MAX(CASE WHEN state = 'Washington' THEN victims_per_1m ELSE 0 END) AS washington

    FROM      mass_shootings.victims_per_1m_by_year_and_state_view
    GROUP BY  year
    ORDER BY  year ASC
  );
