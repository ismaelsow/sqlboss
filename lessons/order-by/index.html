---
layout: lesson
title: ORDER BY
previous_lesson: /lessons/not/
next_lesson: /lessons/offset/
---

<p>By default, the results returned by a SELECT query are not sorted in any specific order. By default, the order of the results is not guaranteed. If we want to ensure a specific order when displaying the result set, we can use the ORDER BY clause to sort the returned rows.</p>

<!-- Example 1 -->
<h3 class="h3-big-margin"><span class="grey-text-span">Example 1</span></h3>
<pre>
  <code class="language-sql">
SELECT      name, retail_price, cost
  FROM      bigquery-public-data.thelook_ecommerce.products
  ORDER BY  retail_price
  LIMIT     10;
  </code>
</pre>
<p><img src="images/example-1.png" class="lesson-img" /></p>

<!-- Example 2 -->
<h3 class="h3-big-margin"><span class="grey-text-span">Example 2</span></h3>
<pre>
  <code class="language-sql">
SELECT      name, retail_price, cost
  FROM      bigquery-public-data.thelook_ecommerce.products
  ORDER BY  retail_price ASC
  LIMIT     10;
  </code>
</pre>
<p><img src="images/example-2.png" class="lesson-img" /></p>

<!-- Example 3 -->
<h3 class="h3-big-margin"><span class="grey-text-span">Example 3</span></h3>
<pre>
  <code class="language-sql">
SELECT      name, retail_price, cost
  FROM      bigquery-public-data.thelook_ecommerce.products
  ORDER BY  retail_price DESC
  LIMIT     10;
  </code>
</pre>
<p><img src="images/example-3.png" class="lesson-img" /></p>

<!-- Example 4 -->
<h3 class="h3-big-margin"><span class="grey-text-span">Example 4</span></h3>
<pre>
  <code class="language-sql">
SELECT      name, cost, retail_price
  FROM      bigquery-public-data.thelook_ecommerce.products
  ORDER BY  cost DESC, 
            retail_price DESC
  LIMIT     10;
  </code>
</pre>
<p><img src="images/example-4.png" class="lesson-img" /></p>


<!-- PRACTICE PROBLEMS -->
{% include practice_problems_intructions.html %}

<h3 class="h3-big-margin"><span class="easy-problem-text-span">NÂ°1 â€” Names of the 10 youngest users</span></h3>
<div class="problem">
  <h4>Tables</h4>
  <p>bigquery-public-data.thelook_ecommerce.users</p>

  <h4>Task</h4>
  <p>Write a query that will display the names of the 10 youngest users, sorted by age from youngest to oldest.</p>
  
  <h4>Example results</h4>
  <p><img src="images/result-1.png" class="lesson-img" /></p>

  <h4>Solution</h4>
  <div class="collapsible-parent">
    <p><a href="#" class="hide-control">ðŸ™ˆ Hide</a><a href="#" class="show-control">ðŸ‘€ Show</a></p>
    <div class="practice-problems-instructions collapsible-item">
      <pre>
        <code class="language-sql">
SELECT      first_name, last_name, age
  FROM      bigquery-public-data.thelook_ecommerce.users
  ORDER BY  age ASC
  LIMIT     10;
        </code>
      </pre>
    </div>
  </div>
</div>


<h3 class="h3-big-margin"><span class="easy-problem-text-span">NÂ°2 â€” Names of the 5 youngest and most recent users</span></h3>
<div class="problem">
  <h4>Tables</h4>
  <p>bigquery-public-data.thelook_ecommerce.users</p>

  <h4>Task</h4>
  <p>Write a query that will display the names of the 5 youngest and most recent users, sorted by age from youngest to oldest, and by creation date from most recent to less recent.</p>
  
  <h4>Example results</h4>
  <p><img src="images/result-2.png" class="lesson-img" /></p>

  <h4>Solution</h4>
  <div class="collapsible-parent">
    <p><a href="#" class="hide-control">ðŸ™ˆ Hide</a><a href="#" class="show-control">ðŸ‘€ Show</a></p>
    <div class="practice-problems-instructions collapsible-item">
      <pre>
        <code class="language-sql">
SELECT      first_name, last_name, age, created_at
  FROM      bigquery-public-data.thelook_ecommerce.users
  ORDER BY  age ASC, created_at DESC
  LIMIT     10;
        </code>
      </pre>
    </div>
  </div>
</div>


<h3 class="h3-big-margin"><span class="medium-problem-text-span">NÂ°3 â€” 12 products with the highest profit margin ratio (in %), ranked by profit margin ratio from top to bottom</span></h3>
<div class="problem">
  <h4>Tables</h4>
  <p>bigquery-public-data.thelook_ecommerce.products</p>

  <h4>Task</h4>
  <ul>
    <li>Write a query that will show the profit margin ratio in percentage for each product.</li>
    <li>Only display 12 rows.</li>
    <li>The profit_margin_ratio_per_product column is defined as the difference between the retail price and the cost, divided by the retail price, and expressed as a percentage (i.e multiplied by 100).</li>
    <li>We also want the profit margin ratio to be greater or equal to 50</li>
    <li>Rank the rows by profit margin ratio from highest to lowest, retail price from highest to lowest, and cost from lowest to highest.</li>
  </ul>
  
  <h4>Example results</h4>
  <p><img src="images/result-3.png" class="lesson-img" /></p>

  <h4>Solution</h4>
  <div class="collapsible-parent">
    <p><a href="#" class="hide-control">ðŸ™ˆ Hide</a><a href="#" class="show-control">ðŸ‘€ Show</a></p>
    <div class="practice-problems-instructions collapsible-item">
      <pre>
        <code class="language-sql">
SELECT      id,
            name,
            cost,
            retail_price,
            ((retail_price - cost) / retail_price) * 100 AS profit_margin_ratio_per_product
  
  FROM      bigquery-public-data.thelook_ecommerce.products
  
  WHERE     ((retail_price - cost) / retail_price) * 100 >= 50
  
  ORDER BY  profit_margin_ratio_per_product DESC,
            retail_price DESC,
            cost ASC
  LIMIT     12;
        </code>
      </pre>
      <p>The aliased column defined in the SELECT clause will not be available in the WHERE clause but will be available in the ORDER BY clause. The reason? The order by which the database execute the different SQL clauses.</p>
      <p><strong>SQL conceptual order of operations</strong></p>
      <table class="table-with-header">
        <thead><th>Step</th><th>Clause</th><th>Description</th></thead>
        <tbody>
          <tr><td>1</td><td>FROM</td><td>Chooses the data to get the data from.</td></tr>
          <tr><td>2</td><td>WHERE</td><td>Filters the data.</td></tr>
          <tr><td>3</td><td>GROUP BY</td><td>Aggregates the data.</td></tr>
          <tr><td>4</td><td>HAVING</td><td>Filters the aggregated data.</td></tr>
          <tr><td>5</td><td>SELECT</td><td>Returns the final data.</td></tr>
          <tr><td>6</td><td>ORDER BY</td><td>Sorts the final data.</td></tr>
          <tr><td>7</td><td>LIMIT</td><td>Limits the number of rows displayed.</td></tr>
        </tbody>
      </table>
      <p>So in our example, the <i>profit_margin_ratio_per_product</i> aliased column defined in our SELECT clause will only be available in step 5, but not in step 2 when the WHERE clause is actually evaluated by the database engine. Thatâ€™s why we can use it in the ORDER BY clause.</p>
    </div>
  </div>
</div>
