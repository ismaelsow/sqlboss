---
layout: lesson
title: PERCENT_RANK
previous_lesson: /lessons/nth-value/
next_lesson: /lessons/pivot/
---

<p><code>PERCENT_RANK</code> used to calculate the percentile of each row within a window. As a reminder, in you are in the 90th percentile (percentile is 0.9), it means that you are in the top 10%.</p>
<p>It doesnâ€™t take any parameters but the <code>ORDER BY</code> clause is required in the <code>OVER</code> function.</p>

<h3 class="h3-big-margin"><span class="grey-text-span">Example</span></h3>
<pre>
  <code class="language-sql">
SELECT    id,
          name,
          retail_price,
          PERCENT_RANK() OVER(ORDER BY retail_price ASC) AS percentile
  
  FROM    bigquery-public-data.thelook_ecommerce.products
ORDER BY  retail_price DESC;
  </code>
</pre>


<!-- PRACTICE PROBLEMS -->
{% include practice_problems_intructions.html %}

<h3 class="h3-big-margin"><span class="easy-problem-text-span">NÂ°1 â€” Average Google Analytics purchase revenue of orders in 90th percentile in January 2021</span></h3>
<div class="problem">
  <h4>Tables</h4>
  <p>bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*</p>

  <h4>Task</h4>
  <p>Write a query that will display the average revenue of orders that are in the 90th percentile, in January 2021.</p>
  
  <h4>Example results</h4>
  <div class="table-wrapper">
    <table class="table-with-header">
      <thead><th>ninetieth_percentile_avg_revenue</th></thead>
      <tbody>
        <tr><td>195.04</td></tr>
      </tbody>
    </table>
  </div>

  <h4>Solution</h4>
  <div class="collapsible-parent">
    <p><a href="#" class="hide-control">ðŸ™ˆ Hide</a><a href="#" class="show-control">ðŸ‘€ Show</a></p>
    <div class="practice-problems-instructions collapsible-item">
      <pre>
        <code class="language-sql">
WITH order_percentiles AS
  ( SELECT  ecommerce.purchase_revenue AS revenue,
            PERCENT_RANK() OVER(ORDER BY ecommerce.purchase_revenue ASC) AS percentile
      FROM  example_dataset.valid_purchase_events('20210101', '20210131')
  )

SELECT  ROUND(AVG(revenue), 2) AS ninetieth_percentile_avg_revenue
  FROM  order_percentiles
  WHERE percentile >= 0.9;
        </code>
      </pre>
    </div>
  </div>
</div>
