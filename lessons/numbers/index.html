---
layout: lesson
title: Numbers
quote: "In philosophy, or religion, or ethics, or politics, 2 and 2 might make 5, but when one was designing a gun or an aeroplane they had to make 4."
previous_lesson: /lessons/main-data-types-and-type-conversion/
next_lesson: /lessons/strings/
---

<p><img src="images/numbers-illustration.png" class="illustration" /></p>

<h3 class="h3-big-margin"><span class="grey-text-span">Numeric types and functions</span></h3>
<p>To deal with numbers, SQL offers a wide range of numeric types and mathematical functions. Have a quick look at the official BigQuery documentation to get an idea:</p>
<ul>
  <li><a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types#numeric_types" target="_blank">Numeric types</a></li>
  <li><a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/mathematical_functions" target="_blank">Mathematical functions</a></li>
</ul>
<p>In the course, we'll mostly focus on the functions that are regularly used in day-to-day work.</p>

<h3 class="h3-big-margin"><span class="grey-text-span">ROUND</span></h3>
<p><code>ROUND</code> takes as parameters the decimal number we want to round, and the number of decimals we want in the end.</p>
<p><strong>Type</strong> the query below in the <a href="https://console.cloud.google.com/bigquery" target="_blank">BigQuery console</a> and run it. Don't copy paste. 😉</p>
<pre>
  <code class="language-sql">
SELECT ROUND(2.4561, 1);
  </code>
</pre>
<p><strong>Example results</strong>:</p>
<p>
  <table class="table-with-header">
    <thead><th>f0_</th></thead>
    <tbody>
      <tr><td>2.5</td></tr>
    </tbody>
  </table>
</p>

<h3 class="h3-big-margin"><span class="grey-text-span">TRUNCATE</span></h3>
<p><code>TRUNCATE</code> takes as parameters the decimal number we want to truncate, and the number of decimals we want in the end.</p>
<p><strong>Type</strong> the query below in the <a href="https://console.cloud.google.com/bigquery" target="_blank">BigQuery console</a> and run it. Don't copy paste. 😉</p>
<pre>
  <code class="language-sql">
SELECT TRUNC(2.4561, 1);
  </code>
</pre>
<p><strong>Example results</strong>:</p>
<p>
  <table class="table-with-header">
    <thead><th>f0_</th></thead>
    <tbody>
      <tr><td>2.4</td></tr>
    </tbody>
  </table>
</p>

<h3 class="h3-big-margin"><span class="grey-text-span">FLOOR</span></h3>
<p><code>FLOOR</code> returns the largest integer that's less than or equal to a given number.</p>
<p><strong>Type</strong> the query below in the <a href="https://console.cloud.google.com/bigquery" target="_blank">BigQuery console</a> and run it. Don't copy paste. 😉</p>
<pre>
  <code class="language-sql">
SELECT FLOOR(2.4561);
  </code>
</pre>
<p><strong>Example results</strong>:</p>
<p>
  <table class="table-with-header">
    <thead><th>f0_</th></thead>
    <tbody>
      <tr><td>2.0</td></tr>
    </tbody>
  </table>
</p>

<h3 class="h3-big-margin"><span class="grey-text-span">CEIL</span></h3>
<p><code>FLOOR</code> returns the smallest integer that's greater than or equal to a given number.</p>
<p><strong>Type</strong> the query below in the <a href="https://console.cloud.google.com/bigquery" target="_blank">BigQuery console</a> and run it. Don't copy paste. 😉</p>
<pre>
  <code class="language-sql">
SELECT CEIL(2.4561); -- or SELECT CEILING(2.4561)
  </code>
</pre>
<p><strong>Example results</strong>:</p>
<p>
  <table class="table-with-header">
    <thead><th>f0_</th></thead>
    <tbody>
      <tr><td>3.0</td></tr>
    </tbody>
  </table>
</p>

<h3 class="h3-big-margin"><span class="grey-text-span">SAFE_DIVIDE</span></h3>
<p>By default, dividing by zero triggers an error. To prevent that from happening, you can use the <code>SAFE_DIVIDE</code> function. As parameters, it takes the numerator and the denominator of the fraction. It returns <code>NULL</code> when a division by zero happens.</p>
<p><strong>Type</strong> the query below in the <a href="https://console.cloud.google.com/bigquery" target="_blank">BigQuery console</a> and run it. Don't copy paste. 😉</p>
<pre>
  <code class="language-sql">
SELECT SAFE_DIVIDE(2.4561, 0);
  </code>
</pre>
<p><strong>Example results</strong>:</p>
<p>
  <table class="table-with-header">
    <thead><th>f0_</th></thead>
    <tbody>
      <tr><td><i>null</i></td></tr>
    </tbody>
  </table>
</p>

<h3 class="h3-big-margin"><span class="grey-text-span">RAND</span></h3>
<p><code>RAND</code> returns a random number between 0 (included) and 1 (excluded). It's used to generate all kind of random numbers, and can also be used in the <code>ORDER BY</code> clause to display the results of <code>SELECT</code> query in random order.
<p><strong>Type</strong> the query below in the <a href="https://console.cloud.google.com/bigquery" target="_blank">BigQuery console</a> and run it. Don't copy paste. 😉</p>
<pre>
  <code class="language-sql">
SELECT RAND();
  </code>
</pre>
<p><strong>Example results</strong>:</p>
<p>
  <table class="table-with-header">
    <thead><th>f0_</th></thead>
    <tbody>
      <tr><td>0.44105372482388427</td></tr>
    </tbody>
  </table>
</p>

<h3 class="h3-big-margin"><span class="grey-text-span">ABS</span></h3>
<p><code>ABS</code> returns the <a href="https://simple.wikipedia.org/wiki/Absolute_value" target="_blank">absolute value</a> of a given number</code>.</p>
<p><strong>Type</strong> the query below in the <a href="https://console.cloud.google.com/bigquery" target="_blank">BigQuery console</a> and run it. Don't copy paste. 😉</p>
<pre>
  <code class="language-sql">
SELECT ABS(-2.4561);
  </code>
</pre>
<p><strong>Example results</strong>:</p>
<p>
  <table class="table-with-header">
    <thead><th>f0_</th></thead>
    <tbody>
      <tr><td>2.4561</td></tr>
    </tbody>
  </table>
</p>


<!-- PRACTICE PROBLEMS -->
{% include practice_problems_intructions.html %}

<h3 class="h3-big-margin"><span class="medium-problem-text-span">N°1 — Profit margin ratio of 10 products&nbsp;&nbsp;🌶️</span></h3>
<div class="problem">
  <h4>Tables</h4>
  <p>bigquery-public-data.thelook_ecommerce.products</p>

  <h4>Task</h4>
  <ul>
    <li>Write a query that will show the profit margin ratio of up to 10 products, as an integer value.</li>
    <li>The <strong>profit_margin_ratio_per_product</strong> column is defined as the difference between the retail price and the cost, divided by the retail price, and expressed as a percentage (i.e multiplied by 100).</li>
    <li>Only the rows where the <strong>profit_margin_ratio_per_product</strong> is at least 50% should be displayed.</li>
  </ul>
  
  <h4>Example results</h4>
  <p><img src="images/result-1.png" class="lesson-img" /></p>

  <h4>Solution</h4>
  <div class="collapsible-parent">
    <p><a href="#" class="hide-control">🙈 Hide</a><a href="#" class="show-control">👀 Show</a></p>
    <div class="practice-problems-instructions collapsible-item">
      <pre>
        <code class="language-sql">
SELECT  id,
        name,
        cost,
        retail_price,
        CAST(((retail_price - cost) / retail_price) * 100 AS INTEGER) AS profit_margin_ratio_per_product
  
  FROM  bigquery-public-data.thelook_ecommerce.products
  WHERE CAST(((retail_price - cost) / retail_price) * 100 AS INTEGER) >= 50
  LIMIT 10;
        </code>
      </pre>
    </div>
  </div>
</div>


<h3 class="h3-big-margin"><span class="medium-problem-text-span">N°2 — 10 random products&nbsp;&nbsp;🌶️</span></h3>
<div class="problem">
  <h4>Tables</h4>
  <p>bigquery-public-data.thelook_ecommerce.products</p>

  <h4>Task</h4>
  <p>Write a query that will display up to 10 products randomly each time it’s run.</p>
  
  <h4>Example results</h4>
  <p><img src="images/result-2.png" class="lesson-img" /></p>

  <h4>Solution</h4>
  <div class="collapsible-parent">
    <p><a href="#" class="hide-control">🙈 Hide</a><a href="#" class="show-control">👀 Show</a></p>
    <div class="practice-problems-instructions collapsible-item">
      <pre>
        <code class="language-sql">
SELECT      id, name
  FROM      bigquery-public-data.thelook_ecommerce.products
  ORDER BY  RAND()
  LIMIT     10;
        </code>
      </pre>
    </div>
  </div>
</div>
